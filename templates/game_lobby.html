{% extends "base.html" %}

{% block title %}Lobby do Jogo - {{ session_name }}{% endblock %}

{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='js/game.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/game.css') }}">
<div class="game-lobby-container">
    <div class="board-center">
    </div>

            <!--<div class="status-effects">
                <h3>Status</h3>
                <ul>
                    {% for status in character['status_effects'] %}
                        <li>
                            <img src="{{ url_for('static', filename='icons/' + status['icon']) }}" alt="{{ status['name'] }}">
                            {{ status['name'] }}: {{ status['description'] }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        
            <div class="attributes">
                <div class="attribute" id="attr-forca">
                    <img src="/static/icons/forca.png" alt="Força">
                    <span>Força: {{ character['forca'] }}</span>
                </div>
                <div class="attribute" id="attr-destreza">
                    <img src="/static/icons/destreza.png" alt="Destreza">
                    <span>Destreza: {{ character['destreza'] }}</span>
                </div>
                <div class="attribute" id="attr-constituicao">
                    <img src="/static/icons/constituicao.png" alt="Constituição">
                    <span>Constituição: {{ character['constituicao'] }}</span>
                </div>
                <div class="attribute" id="attr-inteligencia">
                    <img src="/static/icons/inteligencia.png" alt="Inteligência">
                    <span>Inteligência: {{ character['inteligencia'] }}</span>
                </div>
                <div class="attribute" id="attr-sabedoria">
                    <img src="/static/icons/sabedoria.png" alt="Sabedoria">
                    <span>Sabedoria: {{ character['sabedoria'] }}</span>
                </div>
                <div class="attribute" id="attr-carisma">
                    <img src="/static/icons/carisma.png" alt="Carisma">
                    <span>Carisma: {{ character['carisma'] }}</span>
                </div>
            </div>
-->
        

            <div class="game-lobby-container">
                <div class="main-content">
                    <div class="other-players">
                        <h3>Jogadores na Sessão</h3>
                        <ul>
                            {% for char in other_characters %}
                                <li class="other-player" data-player-id="{{ char['_id'] }}">
                                    <div class="character-frame-small">
                                        <img src="{{ char['img_url'] }}" alt="{{ char['name'] }}" class="character-portrait-small">
                                    </div>
                                    <div class="player-stats">
                                        <p>{{ char['name'] }}</p>
                                        <p>Classe: {{ char['class_name'] }}</p>
                                        <p>Raca: {{ char['race_name'] }}</p>
                                        <p>HP: {{ char['hp'] }}</p>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
            
                    <div class="player-info">
                        <div class="character-frame">
                            <img src="{{ character['img_url'] }}" alt="{{ character['name'] }}" class="character-portrait">
                        </div>
                        <div class="stats-container">
                            <h2>{{ character['name'] }}</h2>
                            <p><strong>Classe:</strong> {{ character['class_name'] }}</p>
                            <p><strong>Raca:</strong> {{ character['race_name'] }}</p>
            
                            <div class="health-mana-bars">
                                <div class="health-ball" data-character-id="{{ character['_id'] }}" data-max-hp="{{ character['hp'] }}">
                                    <div class="health-fill" style="height: {{ (character['current_hp'] | int) / (character['hp'] | int) * 100 }}%"></div>
                                    <div class="health-text">{{ character['current_hp'] }} / {{ character['hp'] }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
                <!-- Barra inferior -->
                <div class="bottom-bar">
                    <div class="bottom-bar-icon" id="profile-button">
                        <img src="{{ character['img_url'] }}" alt="Perfil" class="bottom-bar-icon-img">
                        <span>Perfil</span>
                    </div>
                </div>
                
                <!-- Popups -->
                <div id="media-popup" class="popup media-popup">
                    <div class="popup-content media-content">
                        <!-- Media content will be dynamically injected here -->
                    </div>
                </div>
                
                <div id="profile-popup" class="popup">
                    <div class="popup-content">
                        <span class="close-button">&times;</span>
                        <h2>{{ character['name'] }}</h2>
                        <p><strong>Classe:</strong> {{ character['class_name'] }}</p>
                        <p><strong>Raca:</strong> {{ character['race_name'] }}</p>
                        <div class="attributes">
                            <p><strong>Atributos:</strong></p>
                            <ul>
                                <li>Forca: {{ character['forca'] }}</li>
                                <li>Destreza: {{ character['destreza'] }}</li>
                                <li>Constituicao: {{ character['constituicao'] }}</li>
                                <li>Inteligência: {{ character['inteligencia'] }}</li>
                                <li>Sabedoria: {{ character['sabedoria'] }}</li>
                                <li>Carisma: {{ character['carisma'] }}</li>
                            </ul>
                        </div>
                        <div class="skills">
                            <p><strong>Habilidades:</strong></p>
                            <ul>
                                {% for habilidade in character['habilidades'] %}
                                    <li>{{ habilidade }}</li>
                                {% endfor %}
                            </ul>
                            <p><strong>Perícias:</strong></p>
                            <ul>
                                {% for pericia, valor in character['pericias'].items() %}
                                    <li>{{ pericia }}: +{{ valor }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            
                <div id="other-player-popup" class="popup">
                    <div class="popup-content">
                        <span class="close-button">&times;</span>
                        <div id="other-player-details">
                            <!-- Detalhes do jogador clicado serão carregados via JS -->
                        </div>
                    </div>
                </div>
            </div>
            
            

<script src="{{ url_for('static', filename='js/game.js') }}"></script>
{% endblock %}
